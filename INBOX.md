# Inbox - 今後の改善案

## リファクタリング案

### 1. エラーハンドリング強化
- カスタムエラークラスの作成（`AgentExecutionError`, `GitHubAPIError`, `WorktreeError`等）
- 一時的な障害へのリトライ処理（APIレート制限、ネットワーク問題）
- アクション可能なエラーメッセージの改善

### 2. Cleanup処理の追加
- PR作成成功後のworktreeクリーンアップ
- ブランチ削除オプション（ローカル＋リモート）
- issue-applyに`--cleanup`フラグを実装
- 失敗した実行からの孤立worktreeの処理

### 3. コード構造の整理
- 共通のagent設定を共有モジュールに抽出
- 型定義の統合
- 入力バリデーション層の追加
- テスタビリティ向上のためのDI検討

### 4. テストカバレッジ拡充
- 実際のGit操作を使った統合テスト（一時リポジトリ使用）
- エッジケーステストの追加:
  - 大きなファイルの処理
  - Issueタイトル/本文のUnicode
  - ネットワークタイムアウト
  - 不正なYAMLパース
- モックしたClaude APIでのE2Eテスト

### 5. 追加機能（低優先）
- agent実行中の進捗インジケーター
- 設定可能なログレベル
- GitHub Enterprise対応
- PR/Issueのテンプレートカスタマイズ
- 複数Issue並列処理

## 備考
- 優先順位: エラーハンドリング > Cleanup > コード構造 > テスト
- 変更は最小限かつ焦点を絞る
- 後方互換性を維持する
