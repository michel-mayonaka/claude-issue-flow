---
name: test-check
description: テスト整合性の静的チェック。変更ファイルに対応するテストの存在確認と更新を機械的に行う。
---

# テスト整合性チェック（静的ルール）

コード変更時に、対応するテストファイルの存在と更新を機械的にチェックする。

## 基本ルール

**テストなしでの実装完了は認めない。**

## 静的チェック手順

### Step 1: 変更ファイルの列挙

変更された `.ts` / `.js` / `.tsx` / `.jsx` ファイルを列挙する。
ただし以下は除外：
- `*.test.ts`, `*.spec.ts`（テストファイル自体）
- `*.d.ts`（型定義のみ）
- `types/` 配下（型定義のみ）

### Step 2: 対応テストファイルの確認

各ソースファイルに対して、以下のルールで対応テストファイルを特定：

| ソースファイル | 対応テストファイル |
|--------------|------------------|
| `src/foo.ts` | `src/foo.test.ts` |
| `src/bar/baz.ts` | `src/bar/baz.test.ts` |

### Step 3: アクション実行

対応テストファイルの状態に応じてアクションを実行：

| 状態 | アクション |
|-----|----------|
| テストファイルが**存在しない** | **作成する**（新規ファイルの場合は必須） |
| テストファイルが**存在する** | **確認・更新する**（変更内容に対応しているか） |

### Step 4: テスト実行

変更完了後、テストを実行して全て通ることを確認する。

## チェックリスト

変更された各ソースファイルについて：

- [ ] 対応する `.test.ts` ファイルが存在するか確認した
- [ ] 存在しない場合、テストファイルを作成した
- [ ] 存在する場合、テスト内容が変更に対応しているか確認した
- [ ] 新規追加した関数/クラスのテストを追加した
- [ ] `npm test` が通ることを確認した

## 例

### 例1: 新規ファイル作成時

```
変更ファイル: src/core/init.ts (新規)

チェック:
- src/core/init.test.ts は存在しない

アクション:
- src/core/init.test.ts を作成
- init.ts の全export関数のテストを追加
```

### 例2: 既存ファイル変更時

```
変更ファイル: src/hooks/create-issue.ts (変更)

チェック:
- src/hooks/create-issue.test.ts は存在する

アクション:
- create-issue.test.ts の内容を確認
- 変更した関数のテストが適切か確認・更新
```

## 除外条件

以下の場合はテスト作成/更新をスキップしてよい：

- 型定義のみの変更（`types/index.ts` など）
- 設定ファイルの変更（`tsconfig.json` など）
- ドキュメントのみの変更
