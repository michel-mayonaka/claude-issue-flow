---
name: test-check
description: テスト整合性チェック。コード変更時にテストの実装・改修が適切に行われているか確認する。
---

# テスト整合性チェック

コード変更（`.ts`, `.js`, `.tsx`, `.jsx` 等）がある場合、テストの実装・改修が適切に行われているかを確認する。

## チェック対象の判定

以下の場合にテストチェックを実施：

| 変更の種類 | テストチェック |
|-----------|---------------|
| 新規関数/クラス追加 | 対応するテストファイルの有無を確認 |
| 既存関数のシグネチャ変更 | 既存テストの更新有無を確認 |
| バグ修正 | 再発防止テストの追加を推奨 |
| リファクタリング | 既存テストが通ることを確認 |
| テストファイルのみの変更 | チェック不要 |
| ドキュメントのみの変更 | チェック不要 |

## チェック手順

1. **変更ファイルの特定**
   - 変更されたソースファイルを列挙
   - テストファイル（`*.test.ts`, `*.spec.ts`）とそれ以外を分類

2. **テストファイルの存在確認**
   - 変更されたソースファイルに対応するテストファイルが存在するか
   - 命名規則: `foo.ts` → `foo.test.ts` または `__tests__/foo.test.ts`

3. **テスト内容の確認**
   - 新規追加した関数/exportにテストが書かれているか
   - 変更した関数の既存テストが更新されているか

## チェック観点

- [ ] 新規追加した関数/クラスに対応するテストがあるか
- [ ] 変更した関数のテストが適切に更新されているか
- [ ] テストがない場合、その理由は妥当か（内部実装のみ、型定義のみ等）

## 問題検出時

問題を発見した場合：

1. 具体的な問題箇所を指摘する
2. テストを実装する or 修正案を提案する

例：
```
### テスト整合性の問題

**問題**: 新規関数のテスト未実装
- `src/core/logger.ts` に `saveText()` を追加しましたが、対応するテストがありません

**対応**:
`src/core/logger.test.ts` に以下のテストを追加：
- saveText がファイルにプレーンテキストを保存すること
- 存在しないディレクトリでも init() 後に保存できること
```
